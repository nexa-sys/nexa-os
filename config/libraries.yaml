# NexaOS Userspace Libraries Configuration
#
# This configuration file controls library build settings.
# Library metadata (name, output, version, dependencies) is auto-discovered
# from Cargo.toml files in userspace/lib/.
#
# To add a new library:
#   1. Create directory: userspace/lib/<name>/
#   2. Add Cargo.toml with [package.metadata.nexaos] section:
#      [package.metadata.nexaos]
#      output = "libname"  # Output name without 'lib' prefix
#      version = 1         # SO version number
#   3. Optionally add configuration here to control features/enabled state
#
# Dependencies are automatically resolved from Cargo.toml [dependencies].

# =============================================================================
# Library Settings
# =============================================================================
# Per-library configuration for enabling/disabling and feature control.
# Only libraries that need non-default settings need to be listed here.
# All libraries in userspace/lib/ are built by default.

libraries:
  # Cryptography library - foundation for SSL/TLS
  ncryptolib:
    enabled: true
    features:
      # Enable hardware acceleration if available (AES-NI, SHA extensions)
      hw-accel: false
    config:
      # Supported algorithms (informational)
      algorithms:
        - aes
        - sha256
        - sha512
        - rsa
        - ed25519
        - x25519
  
  # Compression library
  nzip:
    enabled: true
    features:
      gzip: true
      zlib: true
      raw: false
    config:
      default_level: 6
  
  # SSL/TLS library
  nssl:
    enabled: true
    features:
      tls12: true
      tls13: true
      alpn: true
      sni: true
      session-resumption: false
      early-data: false
    config:
      min_version: "1.2"
      max_version: "1.3"
      verify_certs: true
      ca_path: /etc/ssl/certs
  
  # HTTP/2 library
  nh2:
    enabled: true
    features:
      async-tokio: true
      hpack: true
      priority: false
      server-push: true
      flow-control: true
      compat: false
    config:
      max_streams: 100
      window_size: 65535
  
  # HTTP/3 library (NEW - was missing!)
  nh3:
    enabled: true
    features:
      async-tokio: true
      qpack: true
      server-push: false
      compat: false
    config:
      max_streams: 100
  
  # QUIC library
  ntcp2:
    enabled: true
    features:
      async-tokio: true
      qpack: true
      migration: true
      early-data: true
      multipath: false
      datagram: true
      compat: false
    config:
      cc_algo: cubic

# =============================================================================
# Global Build Settings
# =============================================================================

build:
  # Build both static and shared libraries
  static: true
  shared: true
  
  # Strip debug symbols from shared libraries
  strip: true
  
  # Create version symlinks (libfoo.so -> libfoo.so.X)
  versioned_symlinks: true

# =============================================================================
# Installation Paths
# =============================================================================

install:
  # Main library directory in rootfs
  lib64: /lib64
  
  # Also install to sysroot for cross-compilation
  sysroot: true
