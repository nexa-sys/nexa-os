[package]
name = "nurl"
version.workspace = true
edition.workspace = true

[[bin]]
name = "nurl"
path = "src/main.rs"

[dependencies]
nrlib = { workspace = true, optional = true, features = ["panic-handler"] }
nexa_boot_info.workspace = true
nssl = { path = "../../../lib/nssl", optional = true }
nzip = { path = "../../../lib/nzip", optional = true }
nh2 = { path = "../../../lib/nh2", optional = true, default-features = false }

[features]
# By default, use dynamic linking for nssl, nzip and nh2 since nurl is built as
# a dynamically linked binary that loads libnssl.so, libnzip.so, libnh2.so at runtime
default = ["use-nrlib", "https-dynamic", "compression-dynamic", "http2-dynamic"]
use-nrlib = ["nrlib"]
use-nrlib-std = ["nrlib", "nrlib/std"]
# Static linking with nssl (compile-time dependency)
# Use this feature when building nurl as a statically linked binary
https = ["nssl"]
# Dynamic linking with libnssl.so (runtime dependency)
# This is the default for dynamically linked builds
https-dynamic = []
# Static linking with nzip (compile-time dependency)
compression = ["nzip"]
# Dynamic linking with libnzip.so (runtime dependency)
# This is the default for dynamically linked builds
compression-dynamic = []
# HTTP/2 support via nh2 (static linking - nghttp2 ABI compatible)
http2 = ["nh2"]
# HTTP/2 support via libnh2.so (dynamic linking - nghttp2 C ABI)
# This is the default for dynamically linked builds
http2-dynamic = []
http3 = []

